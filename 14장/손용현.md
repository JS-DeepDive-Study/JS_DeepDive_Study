## **> 모던 자바스크립트 Deep Dive 제 14장 전역 변수의 문제점 요약 정리**<br/><br/>

> 전역 변수의 무분별한 사용은 위험하다.

<br/>

### 14.1 변수의 생명 주기

#### 14.1.1 지역 변수의 생명 주기

> **변수**는 자신이 선언된 위치에서 생성되고 소멸한다.
> **전역 변수**의 생명 주기는 애플리케이션의 생명 주기와 같다.
> 하지만 함수 내부에서 선언된 **지역 변수**는 함수가 호출되면 생성되고 함수가 종료하면 소멸한다. 즉 지역변수의 생명 주기는 **함수의 생명 주기와 일치**한다.

```
코드를 입력하세요
```

#### 14.1.2 전역 변수의 생명 주기

> 전역 코드는 명시적인 호출 없이 실행되므로, 코드가 로드되자마자 곧바로 해석되고 실행된다.
> 전역 코드에는 반환문을 사용할 수 없으므로 마지막 문이 실행되어 더 이상 실행할 문이 없을 때 종료한다.
> 따라서 **var 키워드로 선언한 전역 변수의 생명 주기는 전역 객체의 생명 주기와 일치**한다.
> 즉, 전역 객체 window는 웹페이지를 닫기 전까지 유효하다. 따라서 브라우저 환경에서 var 키워드로 선언한 전역 변수는 **웹페이지를 닫을 때까지 유효**하다.

<br/>

### 14.2 전역 변수의 문제점

- **암묵적 결합**: 코드의 어디서든 참조하고 변경할 수 있도록 하는 것을 허용하기 때문에, 코드의 가독성이 나빠지고 의도치 않게 상태가 변경될 위험성이 높아진다.

- **긴 생명 주기**: 생명 주기가 길기 때문에 메모리 리소스를 오랜 기간 소비한다. 또한 전역 변수의 상태를 변경할 수 있는 기회가 많다. var 키워드는 변수의 중복 선언을 허용하므로, 변수 이름이 중복되어 재할당이 이뤄질 가능성이 크다.

- **스코트 체 상에서 종점에 존재**: 변수를 검색할 때 전역 변수가 가장 마지막에 검색된 다는 것을 말한다. 따라서 검색 속도가 느리다.

- **네임스페이스 오염**: JavaScript는 파일이 분리되어 있다고 해도 하나의 전역 스코프를 공유한다. 따라서 다른 파일 내에서 동일한 이름으로 명명된 전역 변수나 전역 함수가 같은 스코프 내에 존재할 경우가 생길 수 있다.

<br/>

### 14.2 전역 변수의 사용을 억제하는 방법

> 전역 변수를 반드시 사용해야 할 이유를 찾지 못한다면 **지역 변수**를 사용해야 한다.
> **변수의 스코프는 좁을수록 좋다.**

#### 14.3.1 즉시 실행 함수

```JAVAScript
(function(){
	var foo=10;
}());
console.log(foo); // ReferenceError
```

모든 코드를 즉시 실행 함수로 감싸면, 모든 변수는 즉시 실행 함수의 지역 변수가 된다. 라이브러리 등에 자주 사용된다.

#### 14.3.2 네임스페이스 객체

```JAVAScript
var MYAPP={};
MYAPP.name='Lee';
console.log(MYAPP.name);
```

전역에 네임스페이스 역할을 담당할 객체를 생성하고 전역 변수처럼 사용하고 싶은 변수를 프로퍼티로 추가한다. (그다지 유용하지 않음)

#### 14.3.3 모듈 패턴

```JAVAScript
ar Counter = (function(){
    //반환하는 객체에 추가하지 않으면 외부에서 접근할 수 없는 private member
    var num = 0;
    //반환되는 객체의 프로퍼티 == 외부로 공개하는 public member
    return {
    	increase(){
        	return ++num;
        }
    	decrease(){
        	return --num;
        }
    };
}());
console.log(Counter.num); //undefined
console.log(Counter.increase()); //1
console.log(Counter.decrease()); //0
```

모듈 패턴은 클래스를 모방해서 관련이 있는 변수와 함수를 모아 즉시 실행 함수로 감싸 하나의 모듈을 만든다. 모듈 패턴은 자바스크립트의 강력한 기능인 클로저를 기반으로 동작한다. **캡슐화**는 객체의 특정 프로퍼티나 메서드를 감출 목적으로 사용된다.

#### 14.3.4 ES6 모듈

ES6 모듈을 사용하면 더는 전역 변수를 사용할 수 없디. ES6 모듈은 파일 자체의 독자적인 모듈 스코프를 제공한다. 따라서 모듈 내에서 var 키워드로 선언한 변수는 더는 전역 변수가 아니며 window 객체의 프로퍼티도 아니다.
